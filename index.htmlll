<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TalentScout AI â€” Find Your Next Hire</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">



<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DESIGN TOKENS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --bg:#07090f; --s1:#0c0f1a; --s2:#111627; --s3:#171e30;
  --b1:rgba(255,255,255,.07); --b2:rgba(255,255,255,.12);
  --ind:#6366f1; --ind-g:rgba(99,102,241,.35);
  --cy:#22d3ee; --cy-g:rgba(34,211,238,.2);
  --gn:#10b981; --am:#f59e0b; --rs:#f43f5e;
  --t1:#e8eaf0; --t2:#94a3b8; --t3:#475569;
  --sw:72px; --sw-exp:250px; --rad:14px; --rad-s:9px;
}
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
body{font-family:'Plus Jakarta Sans',sans-serif;background:var(--bg);color:var(--t1);min-height:100vh;overflow-x:hidden;-webkit-font-smoothing:antialiased}
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--s3);border-radius:99px}

/* â•â•â• UTILS â•â•â• */
.page{display:none;min-height:100vh}
.page.active{display:flex}
.panel{display:none;animation:fup .3s ease}
.panel.active{display:block}
@keyframes fup{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}
@keyframes spin{to{transform:rotate(360deg)}}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(.8)}}
@keyframes orbf{0%,100%{transform:translateY(0) scale(1)}50%{transform:translateY(-28px) scale(1.04)}}
@keyframes shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AUTH PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#auth-page{align-items:center;justify-content:center;flex-direction:column;background:var(--bg);position:relative}
.orbs{position:fixed;inset:0;pointer-events:none;overflow:hidden;z-index:0}
.orb{position:absolute;border-radius:50%;filter:blur(80px);opacity:.3}
.o1{width:600px;height:600px;background:#3730a3;top:-200px;left:-150px;animation:orbf 8s ease-in-out infinite}
.o2{width:500px;height:500px;background:#0e7490;bottom:-150px;right:-100px;animation:orbf 10s ease-in-out infinite reverse}
.o3{width:280px;height:280px;background:#7c3aed;top:40%;left:40%;animation:orbf 12s ease-in-out infinite 2s}

.auth-wrap{position:relative;z-index:2;width:100%;max-width:430px;padding:16px;animation:fup .5s ease}
.brand-hd{text-align:center;margin-bottom:28px}
.brand-row{display:inline-flex;align-items:center;gap:10px;margin-bottom:8px}
.brand-ico{width:44px;height:44px;border-radius:12px;background:linear-gradient(135deg,var(--ind),var(--cy));display:flex;align-items:center;justify-content:center;font-size:20px;box-shadow:0 0 28px var(--ind-g)}
.brand-nm{font-size:24px;font-weight:800;letter-spacing:-.5px;background:linear-gradient(135deg,#fff 40%,var(--cy));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.brand-hd p{font-size:13px;color:var(--t2)}

.glass{background:rgba(12,15,26,.88);border:1px solid var(--b2);border-radius:20px;padding:32px;backdrop-filter:blur(24px);box-shadow:0 32px 64px rgba(0,0,0,.6),inset 0 1px 0 rgba(255,255,255,.06)}

.auth-tabs{display:flex;background:var(--s3);border-radius:var(--rad-s);padding:4px;gap:4px;margin-bottom:26px}
.auth-tab{flex:1;padding:9px;border:none;background:transparent;color:var(--t2);font-family:inherit;font-size:14px;font-weight:600;border-radius:7px;cursor:pointer;transition:all .2s}
.auth-tab.active{background:var(--ind);color:#fff;box-shadow:0 0 20px var(--ind-g)}

.fld{margin-bottom:15px}
.fld label{display:block;font-size:11px;font-weight:700;color:var(--t2);margin-bottom:6px;text-transform:uppercase;letter-spacing:.06em}
.frow2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.inp{width:100%;padding:12px 14px;background:var(--s3);border:1px solid var(--b1);border-radius:var(--rad-s);color:var(--t1);font-family:inherit;font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s}
.inp:focus{border-color:var(--ind);box-shadow:0 0 0 3px var(--ind-g)}
.inp::placeholder{color:var(--t3)}
.inp.err{border-color:var(--rs)!important;box-shadow:0 0 0 3px rgba(244,63,94,.2)!important}

.inp-icon-wrap{position:relative}
.inp-icon-wrap .inp{padding-right:42px}
.inp-toggle{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;color:var(--t3);cursor:pointer;font-size:16px;padding:4px}

.err-msg{font-size:11px;color:var(--rs);margin-top:4px;display:none}
.err-msg.show{display:block}

.btn-main{width:100%;padding:13px;border:none;border-radius:var(--rad-s);background:linear-gradient(135deg,var(--ind),#4f46e5);color:#fff;font-family:inherit;font-size:15px;font-weight:700;cursor:pointer;transition:all .2s;margin-top:4px;box-shadow:0 8px 24px rgba(99,102,241,.3);position:relative;overflow:hidden}
.btn-main:hover{transform:translateY(-2px);box-shadow:0 12px 32px rgba(99,102,241,.45)}
.btn-main:active{transform:none}
.btn-main:disabled{opacity:.6;cursor:not-allowed;transform:none}
.btn-main .spin{display:none;width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:spin 1s linear infinite;margin:0 auto}
.btn-main.loading .btn-txt{display:none}
.btn-main.loading .spin{display:block}

.or-div{display:flex;align-items:center;gap:12px;margin:18px 0;color:var(--t3);font-size:12px}
.or-div::before,.or-div::after{content:'';flex:1;height:1px;background:var(--b1)}

.btn-google{width:100%;padding:12px;border:1px solid var(--b2);border-radius:var(--rad-s);background:var(--s3);color:var(--t1);font-family:inherit;font-size:14px;font-weight:500;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;transition:all .2s}
.btn-google:hover{background:var(--s2);border-color:var(--ind)}
.btn-google:disabled{opacity:.6;cursor:not-allowed}

.auth-note{font-size:12px;color:var(--t3);text-align:center;margin-top:16px}
.auth-note a{color:var(--cy);cursor:pointer;text-decoration:none}
.auth-note a:hover{text-decoration:underline}

.forgot-link{float:right;font-size:11px;color:var(--cy);cursor:pointer;margin-top:4px}
.forgot-link:hover{text-decoration:underline}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   APP LAYOUT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#app-page{flex-direction:row}

/* SIDEBAR */
.sidebar{position:fixed;left:0;top:0;bottom:0;width:var(--sw);background:var(--s1);border-right:1px solid var(--b1);display:flex;flex-direction:column;align-items:center;padding:20px 0;z-index:200;transition:width .25s cubic-bezier(.4,0,.2,1);overflow:hidden}
.sidebar:hover{width:var(--sw-exp)}
.sidebar:hover .sw-txt,.sidebar:hover .nlbl-txt,.sidebar:hover .umeta{opacity:1;max-width:200px;overflow:visible}

.sb-brand{display:flex;align-items:center;gap:10px;padding:0 17px;margin-bottom:32px;width:100%;white-space:nowrap;overflow:hidden}
.sb-ico{width:38px;height:38px;border-radius:10px;flex-shrink:0;background:linear-gradient(135deg,var(--ind),var(--cy));display:flex;align-items:center;justify-content:center;font-size:18px;box-shadow:0 0 20px var(--ind-g)}
.sw-txt{font-size:16px;font-weight:800;letter-spacing:-.3px;background:linear-gradient(135deg,#fff,var(--cy));-webkit-background-clip:text;-webkit-text-fill-color:transparent;opacity:0;transition:opacity .2s .05s;white-space:nowrap;max-width:0;overflow:hidden}

.nav-sec{width:100%;margin-bottom:8px}
.nav-sec-lbl{font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:.1em;color:var(--t3);padding:0 22px;margin:12px 0 4px;white-space:nowrap;overflow:hidden}
.nlbl-txt{opacity:0;transition:opacity .2s;max-width:0;overflow:hidden}

.nav-item{display:flex;align-items:center;gap:12px;padding:10px 17px;cursor:pointer;font-size:13px;font-weight:600;color:var(--t2);border-radius:var(--rad-s);margin:2px 8px;transition:all .15s;white-space:nowrap;overflow:hidden;position:relative}
.nav-item:hover{background:var(--s2);color:var(--t1)}
.nav-item.active{background:rgba(99,102,241,.15);color:var(--ind)}
.nav-item.active::before{content:'';position:absolute;left:0;top:20%;bottom:20%;width:3px;background:var(--ind);border-radius:0 3px 3px 0}
.nav-em{font-size:18px;min-width:20px;text-align:center;flex-shrink:0;transition:transform .15s}
.nav-item:hover .nav-em{transform:scale(1.12)}
.nav-pill{margin-left:auto;background:var(--ind);color:#fff;font-size:10px;font-weight:700;padding:1px 7px;border-radius:99px;flex-shrink:0}

.sb-bot{margin-top:auto;width:100%;padding:12px 10px;border-top:1px solid var(--b1)}
.u-row{display:flex;align-items:center;gap:10px;padding:8px;border-radius:var(--rad-s);cursor:pointer;transition:background .15s;overflow:hidden}
.u-row:hover{background:var(--s2)}
.u-ava{width:34px;height:34px;border-radius:50%;flex-shrink:0;background:linear-gradient(135deg,var(--ind),var(--cy));display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:800;color:#fff}
.umeta{opacity:0;transition:opacity .2s;white-space:nowrap;flex:1;min-width:0;max-width:0;overflow:hidden}
.u-nm{font-size:13px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.u-role{font-size:11px;color:var(--t2)}

/* TOPBAR */
.main{margin-left:var(--sw);flex:1;display:flex;flex-direction:column;min-height:100vh;transition:margin-left .25s}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:14px 28px;border-bottom:1px solid var(--b1);background:rgba(7,9,15,.88);backdrop-filter:blur(16px);position:sticky;top:0;z-index:100;gap:12px}
.tb-left{display:flex;align-items:center;gap:12px;min-width:0;flex:1}
.tb-titles{min-width:0}
.tb-titles h1{font-size:17px;font-weight:800;letter-spacing:-.3px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.tb-titles p{font-size:12px;color:var(--t2);margin-top:1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.tb-right{display:flex;align-items:center;gap:10px;flex-shrink:0}
.ai-badge{display:flex;align-items:center;gap:6px;background:rgba(16,185,129,.1);border:1px solid rgba(16,185,129,.25);color:var(--gn);padding:5px 12px;border-radius:99px;font-size:12px;font-weight:600;white-space:nowrap}
.sdot{width:6px;height:6px;border-radius:50%;background:var(--gn);animation:pulse 2s infinite}
.user-email-badge{display:flex;align-items:center;gap:7px;background:var(--s2);border:1px solid var(--b2);padding:6px 14px;border-radius:99px;font-size:12px;font-weight:600;color:var(--t2);max-width:220px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.user-email-badge .ue-dot{width:26px;height:26px;border-radius:50%;background:linear-gradient(135deg,var(--ind),var(--cy));display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:800;color:#fff;flex-shrink:0}
.tbtn{padding:7px 14px;border:1px solid var(--b2);border-radius:var(--rad-s);background:var(--s2);color:var(--t1);font-family:inherit;font-size:12px;font-weight:600;cursor:pointer;transition:background .15s;white-space:nowrap}
.tbtn:hover{background:var(--s3)}
.ham{display:none;background:none;border:none;color:var(--t1);font-size:22px;cursor:pointer;padding:4px}
.mob-ov{display:none;position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:199;backdrop-filter:blur(4px)}

/* CONTENT */
.content{padding:28px;flex:1}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SHARED COMPONENTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.card{background:var(--s1);border:1px solid var(--b1);border-radius:var(--rad);padding:24px}
.card+.card{margin-top:16px}
.c-ttl{font-size:14px;font-weight:800;letter-spacing:-.2px;margin-bottom:18px;display:flex;align-items:center;gap:8px}
.cdot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.g2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px}
.g4{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
.fg{margin-bottom:16px}
.fg label{display:block;font-size:11px;font-weight:700;color:var(--t2);margin-bottom:6px;text-transform:uppercase;letter-spacing:.07em}
.fi{width:100%;padding:11px 14px;background:var(--s2);border:1px solid var(--b1);border-radius:var(--rad-s);color:var(--t1);font-family:inherit;font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s}
.fi:focus{border-color:var(--ind);box-shadow:0 0 0 3px var(--ind-g)}
.fi::placeholder{color:var(--t3)}
textarea.fi{resize:vertical;min-height:90px;line-height:1.6}
select.fi{cursor:pointer;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;padding-right:36px}

.btn-ind{padding:11px 22px;border:none;border-radius:var(--rad-s);background:linear-gradient(135deg,var(--ind),#4f46e5);color:#fff;font-family:inherit;font-size:13px;font-weight:700;cursor:pointer;display:inline-flex;align-items:center;gap:8px;transition:all .2s;box-shadow:0 4px 16px rgba(99,102,241,.3);white-space:nowrap}
.btn-ind:hover{transform:translateY(-1px);box-shadow:0 8px 24px rgba(99,102,241,.45)}
.btn-ind:active{transform:none}
.btn-ind:disabled{opacity:.5;cursor:not-allowed;transform:none}
.btn-cy{padding:11px 22px;border:none;border-radius:var(--rad-s);background:linear-gradient(135deg,#0891b2,var(--cy));color:#000;font-family:inherit;font-size:13px;font-weight:700;cursor:pointer;display:inline-flex;align-items:center;gap:8px;transition:all .2s;white-space:nowrap}
.btn-cy:hover{transform:translateY(-1px)}
.btn-gh{padding:11px 20px;border:1px solid var(--b2);border-radius:var(--rad-s);background:transparent;color:var(--t2);font-family:inherit;font-size:13px;font-weight:600;cursor:pointer;display:inline-flex;align-items:center;gap:7px;transition:all .15s;white-space:nowrap}
.btn-gh:hover{background:var(--s2);color:var(--t1);border-color:var(--ind)}
.brow{display:flex;gap:10px;flex-wrap:wrap;margin-top:20px}

.tag{display:inline-flex;align-items:center;gap:5px;padding:4px 10px;border-radius:99px;font-size:11px;font-weight:600;background:rgba(99,102,241,.1);border:1px solid rgba(99,102,241,.2);color:#a5b4fc}
.tag.cy{background:rgba(34,211,238,.08);border-color:rgba(34,211,238,.2);color:var(--cy)}
.tag.gn{background:rgba(16,185,129,.1);border-color:rgba(16,185,129,.2);color:var(--gn)}

/* â•â•â• AI SEARCH HERO â•â•â• */
.ai-hero{position:relative;overflow:hidden;background:linear-gradient(135deg,rgba(99,102,241,.1),rgba(34,211,238,.06));border:1px solid rgba(99,102,241,.22);border-radius:20px;padding:36px 32px;margin-bottom:20px}
.ai-hero::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,var(--ind),transparent)}
.ai-grid{position:absolute;inset:0;opacity:.04;background-image:linear-gradient(var(--t1) 1px,transparent 1px),linear-gradient(90deg,var(--t1) 1px,transparent 1px);background-size:32px 32px}
.ai-inner{position:relative;z-index:1}
.ai-badge{display:inline-flex;align-items:center;gap:6px;background:rgba(99,102,241,.15);border:1px solid rgba(99,102,241,.3);color:#a5b4fc;padding:5px 12px;border-radius:99px;font-size:11px;font-weight:700;margin-bottom:14px;text-transform:uppercase;letter-spacing:.05em}
.ai-title{font-size:26px;font-weight:800;letter-spacing:-.5px;margin-bottom:6px;line-height:1.2}
.ai-sub{font-size:14px;color:var(--t2);margin-bottom:24px;max-width:560px}

.mode-toggle{display:flex;gap:4px;background:rgba(0,0,0,.3);border:1px solid var(--b1);border-radius:var(--rad-s);padding:4px;width:fit-content;margin-bottom:22px}
.mtab{padding:8px 18px;border:none;background:transparent;color:var(--t2);font-family:inherit;font-size:13px;font-weight:600;border-radius:7px;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:6px}
.mtab.active{background:var(--ind);color:#fff;box-shadow:0 0 16px var(--ind-g)}

.ai-prompt-wrap{display:flex;gap:10px;align-items:flex-start}
.ai-prompt{flex:1;padding:14px 16px;min-height:58px;background:rgba(0,0,0,.4);border:1px solid rgba(99,102,241,.25);border-radius:var(--rad-s);color:var(--t1);font-family:inherit;font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s;resize:none;line-height:1.6}
.ai-prompt:focus{border-color:var(--ind);box-shadow:0 0 0 3px var(--ind-g)}
.ai-prompt::placeholder{color:var(--t3)}

.btn-run{padding:14px 22px;border:none;border-radius:var(--rad-s);background:linear-gradient(135deg,var(--ind),#818cf8);color:#fff;font-family:inherit;font-size:14px;font-weight:800;cursor:pointer;display:flex;align-items:center;gap:8px;transition:all .2s;box-shadow:0 8px 24px var(--ind-g);flex-shrink:0;white-space:nowrap}
.btn-run:hover{transform:translateY(-2px);box-shadow:0 12px 32px var(--ind-g)}
.btn-run:disabled{opacity:.5;cursor:not-allowed;transform:none}

.chips{display:flex;flex-wrap:wrap;gap:7px;margin-top:14px}
.chip{padding:6px 12px;border-radius:99px;background:rgba(255,255,255,.05);border:1px solid var(--b2);color:var(--t2);font-size:12px;cursor:pointer;transition:all .15s;font-family:inherit}
.chip:hover{background:rgba(99,102,241,.15);border-color:var(--ind);color:#fff}

/* RESULTS */
.res-hd{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;flex-wrap:wrap;gap:10px}
.res-meta{font-size:13px;color:var(--t2)}
.res-meta strong{color:var(--cy);font-size:16px}

.cand-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(290px,1fr));gap:14px}
.cc{background:var(--s2);border:1px solid var(--b1);border-radius:var(--rad);padding:18px;cursor:pointer;transition:border-color .2s,transform .2s,box-shadow .2s;animation:fup .35s ease both;position:relative;overflow:hidden}
.cc::after{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--ind),var(--cy));transform:scaleX(0);transform-origin:left;transition:transform .3s}
.cc:hover{border-color:rgba(99,102,241,.4);transform:translateY(-3px);box-shadow:0 16px 40px rgba(0,0,0,.4)}
.cc:hover::after{transform:scaleX(1)}
.cc-hd{display:flex;gap:12px;margin-bottom:12px}
.cc-ava{width:46px;height:46px;border-radius:50%;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:800;color:#fff}
.cc-info{flex:1;min-width:0}
.cc-nm{font-size:15px;font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.cc-rl{font-size:12px;color:var(--t2);margin-top:2px}
.cc-lc{font-size:11px;color:var(--t3);margin-top:2px}
.cc-exp{font-size:11px;color:var(--t3);margin-top:1px}
.cc-score{text-align:center;flex-shrink:0}
.score-ring{width:46px;height:46px;border-radius:50%;display:flex;align-items:center;justify-content:center;position:relative}
.score-ring::before{content:'';position:absolute;inset:4px;border-radius:50%;background:var(--s2)}
.score-val{position:relative;z-index:1;font-size:11px;font-weight:800}
.score-lbl{font-size:9px;color:var(--t3);margin-top:3px;text-transform:uppercase;letter-spacing:.04em}
.cc-skills{display:flex;flex-wrap:wrap;gap:5px;margin-bottom:14px}
.sk-tag{padding:3px 9px;border-radius:99px;font-size:11px;font-weight:600;background:rgba(34,211,238,.07);border:1px solid rgba(34,211,238,.15);color:var(--cy)}
.cc-acts{display:flex;gap:8px}
.cc-btn{flex:1;padding:8px;border-radius:var(--rad-s);font-family:inherit;font-size:12px;font-weight:700;cursor:pointer;transition:all .15s;border:none;display:flex;align-items:center;justify-content:center;gap:5px}
.cc-btn.p{background:var(--ind);color:#fff}
.cc-btn.p:hover{background:#4f46e5}
.cc-btn.s{background:var(--s3);color:var(--t2)}
.cc-btn.s:hover{background:var(--s1);color:var(--t1)}

.cc-extra{margin-bottom:10px}
.cc-company{font-size:11px;color:var(--t2);display:flex;align-items:center;gap:5px;margin-bottom:4px}

/* EMPTY */
.empty{text-align:center;padding:80px 20px;color:var(--t3)}
.empty-ico{font-size:56px;margin-bottom:16px;display:block}
.empty-ttl{font-size:18px;font-weight:800;color:var(--t1);margin-bottom:8px}
.empty-sub{font-size:14px;max-width:340px;margin:0 auto;line-height:1.6}

/* SKELETON LOADING */
.skel{background:linear-gradient(90deg,var(--s2) 25%,var(--s3) 50%,var(--s2) 75%);background-size:200% 100%;animation:shimmer 1.5s infinite;border-radius:6px}

/* BOOLEAN */
.ctag{display:inline-flex;align-items:center;gap:5px;padding:5px 10px;border-radius:99px;background:rgba(99,102,241,.12);border:1px solid rgba(99,102,241,.25);color:#a5b4fc;font-size:12px;font-weight:600}
.ctag-x{cursor:pointer;color:var(--t3);font-size:16px;line-height:1}
.bool-out{background:rgba(0,0,0,.4);border:1px solid rgba(34,211,238,.2);border-radius:var(--rad-s);padding:18px;margin-top:16px;font-family:'Courier New',monospace;font-size:13px;color:var(--cy);line-height:1.8;word-break:break-all;white-space:pre-wrap}

/* PROFILE SEARCH */
.ps-hero{background:linear-gradient(135deg,rgba(34,211,238,.08),rgba(99,102,241,.06));border:1px solid rgba(34,211,238,.15);border-radius:20px;padding:30px;margin-bottom:20px;position:relative;overflow:hidden}
.ps-hero::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,var(--cy),transparent)}
.ps-tabs{display:flex;border-bottom:1px solid var(--b1);margin-bottom:24px}
.ps-tab{padding:10px 20px;border:none;background:transparent;color:var(--t2);font-family:inherit;font-size:13px;font-weight:600;cursor:pointer;border-bottom:2px solid transparent;transition:all .2s;display:flex;align-items:center;gap:7px;margin-bottom:-1px}
.ps-tab.active{color:var(--cy);border-bottom-color:var(--cy)}
.ps-cont{display:none}
.ps-cont.active{display:block}
.drop-zone{border:2px dashed var(--b2);border-radius:var(--rad);padding:48px 24px;text-align:center;cursor:pointer;transition:all .2s}
.drop-zone:hover{border-color:var(--ind);background:rgba(99,102,241,.04)}

/* MODAL */
.modal-ov{position:fixed;inset:0;background:rgba(0,0,0,.8);backdrop-filter:blur(8px);z-index:9000;display:flex;align-items:center;justify-content:center;padding:20px;opacity:0;pointer-events:none;transition:opacity .25s}
.modal-ov.show{opacity:1;pointer-events:all}
.modal-box{background:var(--s1);border:1px solid var(--b2);border-radius:20px;padding:32px;width:100%;max-width:560px;max-height:90vh;overflow-y:auto;transform:translateY(20px) scale(.97);transition:transform .25s;box-shadow:0 40px 80px rgba(0,0,0,.7)}
.modal-ov.show .modal-box{transform:none}
.modal-hd{display:flex;align-items:center;justify-content:space-between;margin-bottom:24px}
.modal-ttl{font-size:18px;font-weight:800;letter-spacing:-.3px}
.modal-x{width:32px;height:32px;border-radius:8px;border:none;background:var(--s3);color:var(--t2);font-size:18px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .15s}
.modal-x:hover{background:var(--s2)}
.qa-prev{display:flex;align-items:center;gap:12px;background:var(--s2);border:1px solid var(--b1);border-radius:var(--rad-s);padding:16px;margin-bottom:24px}
.qa-ava{width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--ind),var(--cy));display:flex;align-items:center;justify-content:center;font-size:22px;font-weight:800;color:#fff;flex-shrink:0}
.qa-pn{font-size:14px;font-weight:700}
.qa-pr{font-size:12px;color:var(--t2)}

/* PIPELINE */
.pipe-board{display:flex;gap:14px;overflow-x:auto;padding-bottom:16px;min-height:200px}
.pipe-col{min-width:220px;background:var(--s2);border:1px solid var(--b1);border-radius:var(--rad);padding:16px;flex-shrink:0}
.pipe-col-hd{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.pipe-col-nm{font-size:12px;font-weight:800;text-transform:uppercase;letter-spacing:.06em}
.pipe-cnt{padding:2px 8px;border-radius:99px;font-size:10px;font-weight:700;background:var(--s3);color:var(--t2)}
.pipe-card{background:var(--s1);border:1px solid var(--b1);border-radius:var(--rad-s);padding:12px;margin-bottom:10px;cursor:grab}
.pipe-card:hover{box-shadow:0 4px 12px rgba(0,0,0,.4)}
.pipe-nm{font-size:13px;font-weight:700}
.pipe-rl{font-size:11px;color:var(--t2);margin-top:2px}
.pipe-acts{display:flex;gap:5px;margin-top:10px;flex-wrap:wrap}
.pipe-btn{font-size:10px;font-weight:600;padding:4px 8px;border-radius:6px;border:1px solid var(--b1);background:var(--s2);color:var(--t2);cursor:pointer;transition:all .1s;font-family:inherit}
.pipe-btn:hover{border-color:var(--ind);color:#a5b4fc}

/* ANALYTICS */
.stat-c{background:var(--s1);border:1px solid var(--b1);border-radius:var(--rad);padding:20px;transition:border-color .2s}
.stat-c:hover{border-color:var(--b2)}
.stat-v{font-size:36px;font-weight:800;letter-spacing:-1px;margin-bottom:4px}
.stat-l{font-size:12px;color:var(--t2);font-weight:600}
.stat-t{font-size:11px;margin-top:8px}
.t-up{color:var(--gn)}.t-dn{color:var(--rs)}
.bar-ch{display:flex;align-items:flex-end;gap:5px;height:80px;padding:8px 0}
.bar{flex:1;border-radius:4px 4px 0 0;background:linear-gradient(180deg,var(--ind),rgba(99,102,241,.3));min-width:6px;transition:height .5s ease}
.role-it{margin-bottom:14px}
.role-nm{font-size:13px;font-weight:600;margin-bottom:6px;display:flex;justify-content:space-between}
.role-bar{height:5px;background:var(--s3);border-radius:99px;overflow:hidden}
.role-fill{height:100%;border-radius:99px;background:linear-gradient(90deg,var(--ind),var(--cy));transition:width .6s ease}

/* SETTINGS */
.set-row{display:flex;align-items:center;justify-content:space-between;padding:16px 0;border-bottom:1px solid var(--b1);gap:20px}
.set-row:last-child{border:none}
.s-nm{font-size:14px;font-weight:700}
.s-dc{font-size:12px;color:var(--t2);margin-top:3px}
.toggle{width:44px;height:24px;border-radius:99px;background:var(--s3);cursor:pointer;position:relative;border:none;transition:background .2s;flex-shrink:0}
.toggle.on{background:var(--ind)}
.toggle::after{content:'';position:absolute;width:18px;height:18px;border-radius:50%;background:#fff;top:3px;left:3px;transition:transform .2s;box-shadow:0 2px 6px rgba(0,0,0,.3)}
.toggle.on::after{transform:translateX(20px)}

/* LOADER OVERLAY */
.ld-ov{position:fixed;inset:0;z-index:9999;background:rgba(7,9,15,.92);backdrop-filter:blur(10px);display:none;flex-direction:column;align-items:center;justify-content:center;gap:20px}
.ld-ov.show{display:flex}
.ld-ring{width:64px;height:64px;border-radius:50%;border:2px solid transparent;border-top-color:var(--ind);border-right-color:var(--cy);animation:spin 1.2s linear infinite;box-shadow:0 0 30px var(--ind-g)}
.ld-ttl{font-size:16px;font-weight:800}
.ld-sb{font-size:13px;color:var(--t2)}
.ld-steps{display:flex;flex-direction:column;gap:6px;margin-top:8px}
.lstep{font-size:12px;color:var(--t3);display:flex;align-items:center;gap:8px;transition:color .3s}
.lstep.done{color:var(--gn)}.lstep.active{color:var(--cy)}
.lstep-dot{width:6px;height:6px;border-radius:50%;background:currentColor;flex-shrink:0}

/* TOAST */
.toast{position:fixed;bottom:24px;right:24px;z-index:9999;background:var(--s1);border:1px solid var(--b2);border-radius:var(--rad);padding:14px 18px;display:flex;align-items:center;gap:10px;font-size:14px;font-weight:600;box-shadow:0 20px 40px rgba(0,0,0,.5);transform:translateX(120%);transition:transform .3s cubic-bezier(.34,1.56,.64,1);max-width:320px}
.toast.show{transform:translateX(0)}
.toast.success{border-left:3px solid var(--gn)}
.toast.error{border-left:3px solid var(--rs)}

/* PANEL HEADER */
.ph{margin-bottom:24px}
.ph h2{font-size:22px;font-weight:800;letter-spacing:-.5px}
.ph p{font-size:14px;color:var(--t2);margin-top:4px}
.ph-row{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px}

/* CONFIG BANNER */
.config-banner{background:rgba(245,158,11,.1);border:1px solid rgba(245,158,11,.3);border-radius:var(--rad);padding:14px 18px;margin-bottom:20px;display:flex;align-items:flex-start;gap:12px;font-size:13px}
.config-banner.hide{display:none}
.cb-icon{font-size:20px;flex-shrink:0;margin-top:1px}
.cb-txt strong{display:block;font-weight:700;color:var(--am);margin-bottom:4px}
.cb-txt code{background:rgba(245,158,11,.15);padding:2px 6px;border-radius:4px;font-size:12px;color:var(--am)}

/* RESPONSIVE */
@media(max-width:768px){
  :root{--sw:0px}
  .ham{display:block}
  .mob-ov{display:block;pointer-events:none;opacity:0;transition:opacity .2s}
  .mob-ov.show{pointer-events:all;opacity:1}
  .sidebar{width:var(--sw-exp) !important;transform:translateX(-100%);transition:transform .25s;z-index:300}
  .sidebar.open{transform:translateX(0)}
  .sw-txt,.nlbl-txt,.umeta{opacity:1 !important;max-width:200px !important;overflow:visible !important}
  .main{margin-left:0 !important}
  .content{padding:16px}
  .g2,.g3,.g4{grid-template-columns:1fr}
  .cand-grid{grid-template-columns:1fr}
  .topbar{padding:12px 16px}
  .ai-hero{padding:22px 16px}
  .ai-title{font-size:20px}
  .ai-prompt-wrap{flex-direction:column}
  .btn-run{width:100%;justify-content:center}
  .pipe-board{flex-direction:column}
  .pipe-col{min-width:unset}
  .modal-box{padding:22px}
  .brow{flex-direction:column}
  .brow .btn-ind,.brow .btn-cy,.brow .btn-gh{width:100%;justify-content:center}
  .tb-right .ai-badge{display:none}
  .user-email-badge{max-width:140px;font-size:11px}
  .user-email-badge span:last-child{display:none}
}
@media(min-width:769px) and (max-width:1024px){
  .g4{grid-template-columns:1fr 1fr}
  .cand-grid{grid-template-columns:1fr 1fr}
}
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     AUTH PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="auth-page" class="page active">
  <div class="orbs"><div class="orb o1"></div><div class="orb o2"></div><div class="orb o3"></div></div>
  <div class="auth-wrap">
    <div class="brand-hd">
      <div class="brand-row">
        <div class="brand-ico">ğŸ¯</div>
        <div class="brand-nm">TalentScout AI</div>
      </div>
      <p>AI-powered talent sourcing from LinkedIn &amp; beyond</p>
    </div>

    <div class="glass">
      <div class="auth-tabs">
        <button class="auth-tab active" onclick="switchAuthTab('signin',this)">Sign In</button>
        <button class="auth-tab" onclick="switchAuthTab('signup',this)">Sign Up</button>
      </div>

      <!-- SIGN IN -->
      <div id="f-signin">
        <div class="fld">
          <label>Email Address</label>
          <input class="inp" type="email" id="si-email" placeholder="hr@yourcompany.com" autocomplete="email">
          <div class="err-msg" id="si-email-err"></div>
        </div>
        <div class="fld">
          <label>Password</label>
          <div class="inp-icon-wrap">
            <input class="inp" type="password" id="si-pass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password">
            <button class="inp-toggle" onclick="togglePwd('si-pass',this)" type="button">ğŸ‘</button>
          </div>
          <div class="err-msg" id="si-pass-err"></div>
          <span class="forgot-link" onclick="forgotPassword()">Forgot password?</span>
        </div>
        <div class="err-msg" id="si-err" style="margin-bottom:10px;font-size:13px;padding:10px;background:rgba(244,63,94,.08);border-radius:8px;border:1px solid rgba(244,63,94,.2)"></div>
        <button class="btn-main" id="si-btn" onclick="signIn()">
          <span class="btn-txt">Sign In â†’</span>
          <div class="spin"></div>
        </button>
      </div>

      <!-- SIGN UP -->
      <div id="f-signup" style="display:none">
        <div class="frow2">
          <div class="fld"><label>First Name</label><input class="inp" type="text" id="su-fn" placeholder="Jane" autocomplete="given-name"><div class="err-msg" id="su-fn-err"></div></div>
          <div class="fld"><label>Last Name</label><input class="inp" type="text" id="su-ln" placeholder="Doe" autocomplete="family-name"><div class="err-msg" id="su-ln-err"></div></div>
        </div>
        <div class="fld"><label>Work Email</label><input class="inp" type="email" id="su-email" placeholder="hr@yourcompany.com" autocomplete="email"><div class="err-msg" id="su-email-err"></div></div>
        <div class="fld"><label>Company / Organization</label><input class="inp" type="text" id="su-co" placeholder="Acme Corp"><div class="err-msg" id="su-co-err"></div></div>
        <div class="fld">
          <label>Password <span style="color:var(--t3);font-weight:400;text-transform:none;font-size:10px">(min 8 chars)</span></label>
          <div class="inp-icon-wrap">
            <input class="inp" type="password" id="su-pass" placeholder="Create a strong password" autocomplete="new-password">
            <button class="inp-toggle" onclick="togglePwd('su-pass',this)" type="button">ğŸ‘</button>
          </div>
          <div class="err-msg" id="su-pass-err"></div>
        </div>
        <div class="err-msg" id="su-err" style="margin-bottom:10px;font-size:13px;padding:10px;background:rgba(244,63,94,.08);border-radius:8px;border:1px solid rgba(244,63,94,.2)"></div>
        <button class="btn-main" id="su-btn" onclick="signUp()">
          <span class="btn-txt">Create Account â†’</span>
          <div class="spin"></div>
        </button>
      </div>

      <div class="or-div">or continue with</div>
      <button class="btn-google" id="gg-btn" onclick="signInGoogle()">
        <svg width="18" height="18" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
        Continue with Google
      </button>
      <div class="auth-note">By continuing you agree to our <a href="#" onclick="return false">Terms of Service</a> &amp; <a href="#" onclick="return false">Privacy Policy</a></div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     APP PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="app-page" class="page">

  <!-- SIDEBAR -->
  <nav class="sidebar" id="sidebar">
    <div class="sb-brand">
      <div class="sb-ico">ğŸ¯</div>
      <span class="sw-txt">TalentScout</span>
    </div>

    <div class="nav-sec">
      <div class="nav-sec-lbl"><span class="nlbl-txt">Sourcing</span></div>
      <div class="nav-item active" onclick="goPanel('ai-search',this)" title="AI Search"><span class="nav-em">ğŸ¤–</span><span>AI Search</span></div>
      <div class="nav-item" onclick="goPanel('boolean',this)" title="Boolean Query"><span class="nav-em">âš¡</span><span>Boolean Query</span></div>
      <div class="nav-item" onclick="goPanel('profile-search',this)" title="Profile Search"><span class="nav-em">ğŸ”</span><span>Profile Search</span></div>
      <div class="nav-item" onclick="openQA()" title="Quick Add"><span class="nav-em">â•</span><span>Quick Add</span></div>
    </div>

    <div class="nav-sec">
      <div class="nav-sec-lbl"><span class="nlbl-txt">Pipeline</span></div>
      <div class="nav-item" onclick="goPanel('pipeline',this)" title="Candidates">
        <span class="nav-em">ğŸ“‹</span><span>Candidates</span>
        <span class="nav-pill" id="pipe-badge">0</span>
      </div>
    </div>

    <div class="nav-sec">
      <div class="nav-sec-lbl"><span class="nlbl-txt">Insights</span></div>
      <div class="nav-item" onclick="goPanel('analytics',this)" title="Analytics"><span class="nav-em">ğŸ“Š</span><span>Analytics</span></div>
    </div>

    <div class="nav-sec">
      <div class="nav-sec-lbl"><span class="nlbl-txt">Account</span></div>
      <div class="nav-item" onclick="goPanel('settings',this)" title="Settings"><span class="nav-em">âš™ï¸</span><span>Settings</span></div>
    </div>

    <div class="sb-bot">
      <div class="u-row" title="Click to log out" onclick="confirmLogout()">
        <div class="u-ava" id="u-ava">HR</div>
        <div class="umeta">
          <div class="u-nm" id="u-nm">Loadingâ€¦</div>
          <div class="u-role" style="color:var(--rs)">Log out â†©</div>
        </div>
      </div>
    </div>
  </nav>

  <div class="mob-ov" id="mob-ov" onclick="closeSb()"></div>

  <main class="main">
    <header class="topbar">
      <div class="tb-left">
        <button class="ham" onclick="toggleSb()">â˜°</button>
        <div class="tb-titles">
          <h1 id="tb-title">ğŸ¤– AI Search</h1>
          <p id="tb-sub">Describe your ideal candidate and let AI find them</p>
        </div>
      </div>
      <div class="tb-right">
        <div class="ai-badge"><div class="sdot"></div>AI Active</div>
        <div class="user-email-badge" id="user-email-badge">
          <div class="ue-dot" id="ue-dot">HR</div>
          <span id="ue-email">Loadingâ€¦</span>
        </div>
        <button class="tbtn" onclick="openQA()">+ Quick Add</button>
      </div>
    </header>

    <div class="content">

      <!-- CONFIG BANNER (shown when Firebase not configured) -->
      <div class="config-banner" id="config-banner">
        <span class="cb-icon">âš ï¸</span>
        <div class="cb-txt">
          <strong>Demo Mode â€” Configure Firebase for real auth</strong>
          Replace the Firebase config in the script below with your own project credentials from
          <a href="https://console.firebase.google.com" target="_blank" style="color:var(--cy)">Firebase Console</a>.
          Create a project â†’ Enable Email/Password &amp; Google auth â†’ Copy config â†’ Paste into <code>firebaseConfig</code>.
        </div>
      </div>

      <!-- â•â•â• AI SEARCH â•â•â• -->
      <div id="panel-ai-search" class="panel active">
        <div class="ai-hero">
          <div class="ai-grid"></div>
          <div class="ai-inner">

            <h2 class="ai-title">Find Your Perfect Hire</h2>
            <p class="ai-sub">Tell the AI what you need â€” it generates real, detailed candidate profiles from LinkedIn matching your exact criteria.</p>

            <div class="mode-toggle">
              <button class="mtab active" id="mt-ai" onclick="setMode('ai')">âœ¨ AI Auto-Search</button>
              <button class="mtab" id="mt-manual" onclick="setMode('manual')">ğŸ”§ Manual Filters</button>
            </div>

            <!-- AI Prompt Mode -->
            <div id="sec-ai">
              <div class="ai-prompt-wrap">
                <textarea class="ai-prompt" id="ai-q" rows="2" placeholder="e.g. Find me senior React developers in Lagos, Nigeria with 5+ years fintech experience, strong TypeScript and Node.js skills..."></textarea>
                <button class="btn-run" id="ai-run-btn" onclick="runSearch('ai')">âœ¨ Search</button>
              </div>
              <div class="chips">
                <span class="chip" onclick="setQ('Senior ML Engineers with PyTorch and TensorFlow experience in London, 4+ years')">ML Engineers Â· London</span>
                <span class="chip" onclick="setQ('Full stack developers with Node.js and React, 3+ years experience in Lagos Nigeria')">Full Stack Â· Lagos</span>
                <span class="chip" onclick="setQ('Product managers with fintech startup background, 5+ years, open to remote')">PM Â· Fintech Remote</span>
                <span class="chip" onclick="setQ('DevOps engineers with Kubernetes Docker AWS expertise, 4+ years')">DevOps Â· Cloud</span>
                <span class="chip" onclick="setQ('Senior UX designers with Figma, SaaS product experience, 3+ years')">UX Designer Â· SaaS</span>
                <span class="chip" onclick="setQ('Cybersecurity analysts with penetration testing SIEM experience, Nigeria or Ghana')">Cybersecurity Â· Africa</span>
              </div>
            </div>

            <!-- Manual Mode -->
            <div id="sec-manual" style="display:none">
              <div class="g2" style="margin-bottom:14px">
                <div class="fg" style="margin:0"><label>Job Title <span style="color:var(--rs)">*</span></label><input class="fi" id="m-title" placeholder="e.g. Senior Software Engineer"></div>
                <div class="fg" style="margin:0"><label>Location</label><input class="fi" id="m-loc" placeholder="e.g. Lagos, London, Remote"></div>
              </div>
              <div class="fg"><label>Required Skills (comma-separated)</label><input class="fi" id="m-skills" placeholder="e.g. Python, React, AWS, PostgreSQL"></div>
              <div class="g2">
                <div class="fg" style="margin:0"><label>Min. Experience</label><select class="fi" id="m-exp"><option>Any</option><option>1+ years</option><option>3+ years</option><option>5+ years</option><option>8+ years</option><option>10+ years</option></select></div>
                <div class="fg" style="margin:0"><label>Industry</label><select class="fi" id="m-ind"><option>Any</option><option>Fintech</option><option>E-Commerce</option><option>Healthcare</option><option>Edtech</option><option>SaaS</option><option>Gaming</option><option>Consulting</option></select></div>
              </div>
              <div class="fg"><label>Job Description (optional â€” improves matching)</label><textarea class="fi" id="m-desc" style="min-height:80px" placeholder="Paste the full job description for better AI analysis..."></textarea></div>
              <div class="fg"><label>Exclude Terms</label><input class="fi" id="m-excl" placeholder="e.g. intern, junior, freelance"></div>
              <div style="margin-top:16px"><button class="btn-run" style="width:100%;justify-content:center" id="manual-run-btn" onclick="runSearch('manual')">ğŸ” Search Candidates</button></div>
            </div>
          </div>
        </div>

        <!-- Results -->
        <div id="res-area" style="display:none">
          <div class="res-hd">
            <div class="res-meta">AI found <strong id="res-cnt">0</strong> matching candidates</div>
            <div style="display:flex;gap:8px;flex-wrap:wrap">
              <button class="btn-gh" style="padding:8px 14px;font-size:12px" onclick="exportCSV()">â¬‡ Export CSV</button>
              <button class="btn-gh" style="padding:8px 14px;font-size:12px" onclick="addAll()">+ Add All to Pipeline</button>
            </div>
          </div>
          <div class="cand-grid" id="cand-grid"></div>
        </div>

        <div id="res-empty" class="empty">
          <span class="empty-ico">ğŸ¯</span>
          <div class="empty-ttl">AI Agent Ready</div>
          <div class="empty-sub">Describe who you're looking for or use manual filters. The AI generates detailed LinkedIn-style candidates scored and ranked for your role.</div>
        </div>
      </div>

      <!-- â•â•â• BOOLEAN QUERY â•â•â• -->
      <div id="panel-boolean" class="panel">
        <div class="ph"><h2>Boolean Query Generator</h2><p>Build precision LinkedIn search strings</p></div>
        <div class="card">
          <div class="c-ttl"><div class="cdot" style="background:var(--ind)"></div> Search Criteria</div>
          <div class="g2">
            <div class="fg"><label>Must-Have Titles</label><input class="fi" id="b-titles" placeholder="Senior Software Engineer, Backend Engineer"></div>
            <div class="fg"><label>Must-Have Skills</label><input class="fi" id="b-skills" placeholder="Python, Django, PostgreSQL"></div>
            <div class="fg"><label>Optional Skills</label><input class="fi" id="b-opt" placeholder="Redis, Docker, Elasticsearch"></div>
            <div class="fg"><label>Include Terms</label><input class="fi" id="b-inc" placeholder="fintech, startup, scale-up"></div>
            <div class="fg"><label>Exclude Terms</label><input class="fi" id="b-exc" placeholder="intern, junior, contractor"></div>
            <div class="fg"><label>Regions / Cities</label><input class="fi" id="b-reg" placeholder="Lagos, London, Accra, Remote"></div>
            <div class="fg">
              <label>Countries</label>
              <div id="ctag-list" style="display:flex;flex-wrap:wrap;gap:6px;margin-bottom:8px">
                <span class="ctag">ğŸŒ Global <span class="ctag-x" onclick="this.parentElement.remove()">Ã—</span></span>
              </div>
              <input class="fi" id="b-country" placeholder="Type a country and press Enter" onkeydown="addCtag(event)">
            </div>
            <div class="fg"><label>LinkedIn Country Codes</label><input class="fi" id="b-codes" placeholder="e.g. ng, gh, gb, us"></div>
          </div>
          <div class="g2">
            <div class="fg"><label>Query Style</label><select class="fi" id="b-style"><option>Recommended (Balanced)</option><option>Strict (AND only)</option><option>Flexible (OR heavy)</option><option>Exact Match</option></select></div>
            <div class="fg"><label>Platform</label><select class="fi" id="b-plat"><option>LinkedIn</option><option>GitHub</option><option>Indeed</option><option>Google X-Ray Search</option></select></div>
          </div>
          <div class="brow">
            <button class="btn-ind" onclick="genBool()">âš¡ Generate Query</button>
            <button class="btn-gh" onclick="clearBool()">ğŸ—‘ Clear All</button>
          </div>
        </div>
        <div id="bool-res" style="display:none">
          <div class="card">
            <div class="c-ttl"><div class="cdot" style="background:var(--cy)"></div> Generated Boolean String</div>
            <div class="bool-out" id="bool-txt"></div>
            <div class="brow">
              <button class="btn-cy" onclick="copyBool()">ğŸ“‹ Copy to Clipboard</button>
              <button class="btn-gh" onclick="liSearch()">ğŸ”— Open in LinkedIn</button>
            </div>
          </div>
        </div>
      </div>

      <!-- â•â•â• PROFILE SEARCH â•â•â• -->
      <div id="panel-profile-search" class="panel">
        <div class="ph ph-row"><div><h2>Profile Search</h2><p>Analyze a LinkedIn profile or search with a boolean query</p></div></div>
        <div class="ps-hero">
          <div class="ps-tabs">
            <button class="ps-tab active" onclick="pstab('li',this)">
              <svg width="15" height="15" viewBox="0 0 24 24" fill="#0a66c2"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
              LinkedIn Profile
            </button>
            <button class="ps-tab" onclick="pstab('resume',this)">ğŸ“„ Resume Upload</button>
            <button class="ps-tab" onclick="pstab('qsearch',this)">ğŸ” Query Search</button>
          </div>

          <div class="ps-cont active" id="ps-li">
            <div class="fg"><label>LinkedIn Profile URL <span style="color:var(--rs)">*</span></label><input class="fi" id="ps-url" placeholder="https://www.linkedin.com/in/username"></div>
            <div style="font-size:13px;font-weight:700;color:var(--t2);margin:16px 0 12px">Job Requirements <span style="font-weight:400;color:var(--t3)">(Optional â€” improves analysis)</span></div>
            <div class="g2">
              <div class="fg"><label>Job Title</label><input class="fi" id="ps-jt" placeholder="e.g. Senior Software Engineer"></div>
              <div class="fg"><label>Location Preference</label><input class="fi" id="ps-jl" placeholder="e.g. Lagos or Remote"></div>
            </div>
            <div class="fg"><label>Required Skills</label><input class="fi" id="ps-js" placeholder="Python, React, AWS (comma-separated)"></div>
            <div class="fg"><label>Full Job Description</label><textarea class="fi" id="ps-jd" placeholder="Paste the full job description here for better analysis..."></textarea></div>
            <div class="brow"><button class="btn-ind" onclick="scrapeProfile()">ğŸ¤– Scrape &amp; Analyze</button></div>
          </div>

          <div class="ps-cont" id="ps-resume">
            <div class="drop-zone" onclick="document.getElementById('rf').click()">
              <div style="font-size:40px;margin-bottom:12px">ğŸ“„</div>
              <div style="font-size:16px;font-weight:700;margin-bottom:6px">Drop resume here or click to upload</div>
              <div style="font-size:13px;color:var(--t2)">Supports PDF, DOCX, TXT â€” Max 10MB</div>
              <input type="file" id="rf" accept=".pdf,.doc,.docx,.txt" style="display:none" onchange="onResume(this)">
            </div>
            <div id="rf-name" style="display:none;margin-top:12px"></div>
            <div class="g2" style="margin-top:16px">
              <div class="fg"><label>Target Job Title</label><input class="fi" placeholder="e.g. Senior Backend Engineer"></div>
              <div class="fg"><label>Company Type</label><select class="fi"><option>Any</option><option>Startup</option><option>Enterprise</option><option>Agency</option><option>Non-profit</option></select></div>
            </div>
            <button class="btn-ind" onclick="toast('Resume analysis requires backend AI integration. See README for setup.','error')">ğŸ¤– Analyze Resume</button>
          </div>

          <div class="ps-cont" id="ps-qsearch">
            <div class="fg"><label>Search Query</label><textarea class="fi" id="ps-q" style="min-height:80px" placeholder='"Senior Engineer" AND ("React" OR "Vue") AND "Nigeria" NOT "intern"'></textarea></div>
            <div class="g2">
              <div class="fg"><label>Platform</label><select class="fi" id="ps-plat"><option>LinkedIn</option><option>GitHub</option><option>Indeed</option><option>Google X-Ray</option></select></div>
              <div class="fg"><label>Max Results</label><select class="fi" id="ps-max"><option>10</option><option selected>25</option><option>50</option><option>100</option></select></div>
            </div>
            <button class="btn-ind" onclick="psQuery()">ğŸ” Search Profiles</button>
          </div>
        </div>

        <div id="ps-result" style="display:none">
          <div class="card">
            <div class="c-ttl"><div class="cdot" style="background:var(--gn)"></div> Profile Analysis Result</div>
            <div id="ps-result-body"></div>
          </div>
        </div>
      </div>

      <!-- â•â•â• PIPELINE â•â•â• -->
      <div id="panel-pipeline" class="panel">
        <div class="ph ph-row">
          <div><h2>Candidate Pipeline</h2><p>Track candidates through your hiring stages</p></div>
          <button class="btn-ind" onclick="openQA()">+ Add Candidate</button>
        </div>
        <div class="pipe-board" id="pipe-board"></div>
      </div>

      <!-- â•â•â• ANALYTICS â•â•â• -->
      <div id="panel-analytics" class="panel">
        <div class="ph"><h2>Analytics &amp; Insights</h2><p>Your sourcing performance at a glance</p></div>
        <div class="g4" style="margin-bottom:20px">
          <div class="stat-c"><div class="stat-v" style="color:var(--ind)" id="st-searches">0</div><div class="stat-l">Total Searches</div><div class="stat-t t-up">â†‘ AI-powered</div></div>
          <div class="stat-c"><div class="stat-v" style="color:var(--cy)" id="st-scanned">0</div><div class="stat-l">Profiles Scanned</div><div class="stat-t t-up">â†‘ This session</div></div>
          <div class="stat-c"><div class="stat-v" style="color:var(--gn)" id="st-pipe">0</div><div class="stat-l">In Pipeline</div><div class="stat-t t-up">Updated live</div></div>
          <div class="stat-c"><div class="stat-v" style="color:var(--am)" id="st-hired">0</div><div class="stat-l">Hired This Month</div><div class="stat-t t-up">Updated live</div></div>
        </div>
        <div class="g2">
          <div class="card"><div class="c-ttl"><div class="cdot" style="background:var(--ind)"></div> Search Activity (Last 2 Weeks)</div><div class="bar-ch" id="bar-ch"></div></div>
          <div class="card"><div class="c-ttl"><div class="cdot" style="background:var(--cy)"></div> Top Searched Roles</div><div id="top-roles"></div></div>
        </div>
      </div>

      <!-- â•â•â• SETTINGS â•â•â• -->
      <div id="panel-settings" class="panel">
        <div class="ph"><h2>Settings</h2><p>Manage your account and preferences</p></div>
        <div class="card">
          <div class="c-ttl"><div class="cdot" style="background:var(--ind)"></div> Account</div>
          <div class="g2">
            <div class="fg"><label>Full Name</label><input class="fi" id="set-nm" placeholder="Jane Doe"></div>
            <div class="fg"><label>Email</label><input class="fi" id="set-em" placeholder="hr@company.com" readonly style="opacity:.6"></div>
            <div class="fg"><label>Company</label><input class="fi" id="set-co" placeholder="Acme Corp"></div>
            <div class="fg"><label>Role / Title</label><input class="fi" id="set-rl" placeholder="HR Manager"></div>
          </div>
          <button class="btn-ind" onclick="saveSettings()">ğŸ’¾ Save Changes</button>
        </div>
        <div class="card">
          <div class="c-ttl"><div class="cdot" style="background:#0a66c2"></div> Integrations</div>
          <div class="set-row"><div><div class="s-nm">LinkedIn API</div><div class="s-dc">Connect for real-time profile sourcing (requires LinkedIn Partner Program)</div></div><button class="btn-gh" onclick="toast('LinkedIn API requires official Partner Program approval from LinkedIn.','error')">Connect</button></div>
          <div class="set-row"><div><div class="s-nm">Airtable</div><div class="s-dc">Sync candidates to your Airtable database</div></div><button class="btn-gh" onclick="toast('Enter your Airtable API key in settings to connect.','success')">Connect</button></div>
          <div class="set-row"><div><div class="s-nm">Slack Notifications</div><div class="s-dc">Get notified when new top matches are found</div></div><button class="toggle on" id="slack-toggle" onclick="this.classList.toggle('on')"></button></div>
          <div class="set-row"><div><div class="s-nm">Email Alerts</div><div class="s-dc">Weekly digest of top candidates</div></div><button class="toggle on" id="email-toggle" onclick="this.classList.toggle('on')"></button></div>
        </div>
        <div class="card">
          <div class="c-ttl"><div class="cdot" style="background:var(--gn)"></div> AI Preferences</div>
          <div class="set-row"><div><div class="s-nm">Auto-score candidates</div><div class="s-dc">AI ranks every search result by match quality</div></div><button class="toggle on" onclick="this.classList.toggle('on')"></button></div>
          <div class="set-row">
            <div><div class="s-nm">Match threshold: <span id="thresh-val">70</span>%</div><div class="s-dc">Only show candidates scoring above this threshold</div></div>
            <input type="range" min="50" max="100" value="70" style="width:140px;accent-color:var(--ind)" oninput="document.getElementById('thresh-val').textContent=this.value">
          </div>
          <div class="set-row"><div><div class="s-nm">Results per search</div><div class="s-dc">Maximum candidates returned per query</div></div><select class="fi" style="width:80px"><option>10</option><option>25</option><option selected>50</option><option>100</option></select></div>
        </div>
        <div class="card" style="margin-top:16px">
          <div class="c-ttl"><div class="cdot" style="background:var(--rs)"></div> Danger Zone</div>
          <div class="set-row"><div><div class="s-nm">Clear All Pipeline Data</div><div class="s-dc">Remove all candidates from the pipeline</div></div><button class="btn-gh" style="border-color:rgba(244,63,94,.3);color:var(--rs)" onclick="clearPipeline()">Clear Pipeline</button></div>
          <div class="set-row"><div><div class="s-nm">Sign Out</div><div class="s-dc">Sign out of your account on this device</div></div><button class="btn-gh" style="border-color:rgba(244,63,94,.3);color:var(--rs)" onclick="confirmLogout()">Sign Out</button></div>
        </div>
      </div>

    </div><!-- /content -->
  </main>
</div>

<!-- â•â• QUICK ADD MODAL â•â• -->
<div class="modal-ov" id="qa-modal" onclick="if(event.target===this)closeQA()">
  <div class="modal-box">
    <div class="modal-hd">
      <div class="modal-ttl">â• Quick Add Candidate</div>
      <button class="modal-x" onclick="closeQA()">âœ•</button>
    </div>
    <div class="qa-prev">
      <div class="qa-ava" id="qa-ava-big">?</div>
      <div>
        <div class="qa-pn" id="qa-pn">New Candidate</div>
        <div class="qa-pr" id="qa-pr">Enter details below</div>
      </div>
    </div>
    <div class="g2">
      <div class="fg"><label>Full Name <span style="color:var(--rs)">*</span></label><input class="fi" id="qa-nm" placeholder="John Smith" oninput="qaPreview()"></div>
      <div class="fg"><label>Current Title</label><input class="fi" id="qa-tt" placeholder="Senior Software Engineer" oninput="qaPreview()"></div>
    </div>
    <div class="fg"><label>LinkedIn Profile URL</label><input class="fi" id="qa-li" placeholder="linkedin.com/in/johnsmith"></div>
    <div class="g2">
      <div class="fg"><label>Location</label><input class="fi" id="qa-lc" placeholder="Lagos, Nigeria"></div>
      <div class="fg"><label>Email</label><input class="fi" id="qa-em" placeholder="john@email.com" type="email"></div>
    </div>
    <div class="fg"><label>Current Company</label><input class="fi" id="qa-co" placeholder="Google, Flutterwaveâ€¦"></div>
    <div class="fg"><label>Years of Experience</label><select class="fi" id="qa-yrs"><option>1â€“2 years</option><option>3â€“4 years</option><option selected>5â€“7 years</option><option>8â€“10 years</option><option>10+ years</option></select></div>
    <div class="fg"><label>Key Skills (comma-separated)</label><input class="fi" id="qa-sk" placeholder="React, Node.js, TypeScript, AWS"></div>
    <div class="g2">
      <div class="fg"><label>Pipeline Stage</label>
        <select class="fi" id="qa-stage">
          <option>New Lead</option><option>Contacted</option><option>Screening</option><option>Interview</option><option>Offer</option><option>Hired</option>
        </select>
      </div>
      <div class="fg"><label>Source</label>
        <select class="fi" id="qa-src">
          <option>LinkedIn</option><option>Referral</option><option>Job Board</option><option>GitHub</option><option>Headhunt</option><option>Other</option>
        </select>
      </div>
    </div>
    <div class="fg"><label>Notes</label><textarea class="fi" id="qa-nt" style="min-height:70px" placeholder="Any notes about this candidate..."></textarea></div>
    <div class="brow" style="margin-top:8px">
      <button class="btn-ind" style="flex:1;justify-content:center" onclick="submitQA()">âœ… Add to Pipeline</button>
      <button class="btn-gh" onclick="closeQA()">Cancel</button>
    </div>
  </div>
</div>

<!-- LOADER -->
<div class="ld-ov" id="ld-ov">
  <div class="ld-ring"></div>
  <div class="ld-ttl" id="ld-ttl">Searchingâ€¦</div>
  <div class="ld-sb" id="ld-sb">Please wait</div>
  <div class="ld-steps" id="ld-steps"></div>
</div>

<!-- TOAST -->
<div class="toast" id="toast-el">
  <span id="toast-ico">âœ…</span>
  <span id="toast-msg">Done!</span>
</div>

<!-- Firebase via ES Modules (most reliable, no race conditions) -->
<script type="module">
import { initializeApp }                              from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
import { getAuth, onAuthStateChanged, signInWithEmailAndPassword,
         createUserWithEmailAndPassword, signInWithPopup,
         GoogleAuthProvider, signOut, sendPasswordResetEmail,
         updateProfile }                              from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
import { getFirestore, doc, getDoc, setDoc, updateDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

/* â”€â”€â”€ CONFIG â”€â”€â”€ */
const firebaseConfig = {
  apiKey:            "AIzaSyBW-wPDMkWaMSW9EUP-QwvVsTI6Xab-ARI",
  authDomain:        "talentscout-ai-d3413.firebaseapp.com",
  projectId:         "talentscout-ai-d3413",
  storageBucket:     "talentscout-ai-d3413.firebasestorage.app",
  messagingSenderId: "288194908732",
  appId:             "1:288194908732:web:8215676f46d6d889bc2939",
  measurementId:     "G-XJ5FR2DKBY"
};

const app  = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db   = getFirestore(app);

/* â”€â”€â”€ expose to global scope so non-module functions can call them â”€â”€â”€ */
window._fbAuth   = auth;
window._fbDb     = db;
window._fbSignIn = (email, pass) => signInWithEmailAndPassword(auth, email, pass);
window._fbSignUp = async (email, pass, name) => {
  const cred = await createUserWithEmailAndPassword(auth, email, pass);
  await updateProfile(cred.user, { displayName: name });
  return cred;
};
window._fbGoogle = async () => {
  const provider = new GoogleAuthProvider();
  provider.setCustomParameters({ prompt: 'select_account' });
  return signInWithPopup(auth, provider);
};
window._fbSignOut      = () => signOut(auth);
window._fbResetPwd     = (email) => sendPasswordResetEmail(auth, email);
window._fbGetDoc       = (uid) => getDoc(doc(db, 'users', uid));
window._fbSetDoc       = (uid, data) => setDoc(doc(db, 'users', uid), data, { merge: true });
window._fbUpdateDoc    = (uid, data) => updateDoc(doc(db, 'users', uid), data);
window._fbDocRef       = (uid) => doc(db, 'users', uid);

/* â”€â”€â”€ Auth state â€” bridge into global app â”€â”€â”€ */
onAuthStateChanged(auth, user => {
  if (user) {
    window._currentUser = user;
    if (typeof enterApp === 'function') {
      enterApp(user.displayName || user.email.split('@')[0], user.email);
    }
  } else {
    window._currentUser = null;
    if (typeof showAuth === 'function') showAuth();
  }
});

console.log('âœ… Firebase loaded successfully via ES Modules');
window._fbReady = true;
// Resolve any pending calls that were waiting
if (typeof window._fbReadyResolve === 'function') window._fbReadyResolve();
</script>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FIREBASE BRIDGE HELPERS  (called by auth functions below)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function getFirebaseErrorMsg(code) {
  const m = {
    'auth/user-not-found':        'No account found with this email. Please sign up.',
    'auth/wrong-password':        'Incorrect password. Please try again.',
    'auth/invalid-email':         'Please enter a valid email address.',
    'auth/email-already-in-use':  'An account with this email already exists. Sign in instead.',
    'auth/weak-password':         'Password must be at least 8 characters.',
    'auth/network-request-failed':'Network error. Please check your connection.',
    'auth/too-many-requests':     'Too many attempts. Please wait a moment and try again.',
    'auth/popup-closed-by-user':  null,
    'auth/cancelled-popup-request': null,
    'auth/invalid-credential':    'Invalid email or password. Please check and try again.',
    'auth/popup-blocked':         'Popup was blocked by your browser. Please allow popups for this site.',
  };
  return m[code] !== undefined ? m[code] : 'Something went wrong. Please try again.';
}

const DEMO_MODE = false;

/* Wait up to 8 seconds for the ES module to finish loading Firebase */
function waitForFirebase() {
  if (window._fbReady) return Promise.resolve();
  return new Promise((resolve, reject) => {
    window._fbReadyResolve = resolve;
    setTimeout(() => reject(new Error('Firebase took too long to load. Please refresh the page.')), 8000);
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   APP STATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let currentUser = null; // kept in sync by onAuthStateChanged above
const STAGES = ['New Lead','Contacted','Screening','Interview','Offer','Hired'];
const STAGE_COLORS = {'New Lead':'var(--cy)','Contacted':'var(--ind)','Screening':'var(--am)','Interview':'#a855f7','Offer':'var(--gn)','Hired':'#22c55e'};
const AV_COLORS = ['#7c3aed','#0891b2','#10b981','#f59e0b','#ef4444','#8b5cf6','#06b6d4','#ec4899','#14b8a6','#f97316','#6366f1','#a855f7'];

let pipeline = Object.fromEntries(STAGES.map(s => [s, []]));
let searchResults = [];
let totalSearches = 0;
let totalScanned = 0;
let userData = {};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AUTH HELPERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function switchAuthTab(t, btn) {
  document.querySelectorAll('.auth-tab').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById('f-signin').style.display = t === 'signin' ? 'block' : 'none';
  document.getElementById('f-signup').style.display = t === 'signup' ? 'block' : 'none';
  clearAuthErrors();
}

function clearAuthErrors() {
  document.querySelectorAll('.err-msg').forEach(e => { e.classList.remove('show'); e.textContent = ''; });
  document.querySelectorAll('.inp').forEach(i => i.classList.remove('err'));
}

function showError(fieldId, msg) {
  const el = document.getElementById(fieldId + '-err');
  const inp = document.getElementById(fieldId);
  if (el) { el.textContent = msg; el.classList.add('show'); }
  if (inp) inp.classList.add('err');
}

function showFormError(formId, msg) {
  const el = document.getElementById(formId + '-err');
  if (el) { el.textContent = msg; el.classList.add('show'); }
}

function setLoading(btnId, loading) {
  const btn = document.getElementById(btnId);
  if (!btn) return;
  btn.disabled = loading;
  btn.classList.toggle('loading', loading);
  if (btnId === 'gg-btn') {
    btn.disabled = loading;
    if (loading) {
      btn.innerHTML = `<div style="width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:spin 1s linear infinite;margin:0 auto"></div> Signing inâ€¦`;
    } else {
      btn.innerHTML = `<svg width="18" height="18" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg> Continue with Google`;
    }
  }
}

function togglePwd(id, btn) {
  const inp = document.getElementById(id);
  const isText = inp.type === 'text';
  inp.type = isText ? 'password' : 'text';
  btn.textContent = isText ? 'ğŸ‘' : 'ğŸ™ˆ';
}

async function signIn() {
  clearAuthErrors();
  const email = document.getElementById('si-email').value.trim();
  const pass  = document.getElementById('si-pass').value;
  let valid = true;
  if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { showError('si-email', 'Enter a valid email address'); valid = false; }
  if (!pass || pass.length < 6) { showError('si-pass', 'Password must be at least 6 characters'); valid = false; }
  if (!valid) return;

  setLoading('si-btn', true);
  try {
    await waitForFirebase();
    await window._fbSignIn(email, pass);
    // onAuthStateChanged fires â†’ enterApp() called automatically
  } catch (e) {
    setLoading('si-btn', false);
    showFormError('si', e.message.includes('Firebase') ? e.message : getFirebaseErrorMsg(e.code));
  }
}

async function signUp() {
  clearAuthErrors();
  const fn    = document.getElementById('su-fn').value.trim();
  const ln    = document.getElementById('su-ln').value.trim();
  const email = document.getElementById('su-email').value.trim();
  const co    = document.getElementById('su-co').value.trim();
  const pass  = document.getElementById('su-pass').value;
  let valid = true;

  if (!fn)   { showError('su-fn',    'First name is required'); valid = false; }
  if (!ln)   { showError('su-ln',    'Last name is required'); valid = false; }
  if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) { showError('su-email', 'Enter a valid email address'); valid = false; }
  if (!co)   { showError('su-co',    'Company name is required'); valid = false; }
  if (!pass || pass.length < 8) { showError('su-pass', 'Password must be at least 8 characters'); valid = false; }
  if (!valid) return;

  if (!window._fbSignUp) { showFormError('su', 'Firebase not ready yet â€” please wait a moment.'); return; }

  setLoading('su-btn', true);
  try {
    await waitForFirebase();
    const cred = await window._fbSignUp(email, pass, `${fn} ${ln}`);
    if (window._fbSetDoc) {
      await window._fbSetDoc(cred.user.uid, { name: `${fn} ${ln}`, company: co, email, createdAt: new Date().toISOString() });
    }
    // onAuthStateChanged fires â†’ enterApp() called automatically
  } catch (e) {
    setLoading('su-btn', false);
    showFormError('su', getFirebaseErrorMsg(e.code));
  }
}

async function signInGoogle() {
  setLoading('gg-btn', true);
  try {
    await waitForFirebase();
    await window._fbGoogle();
    // onAuthStateChanged fires â†’ enterApp() called automatically
  } catch (e) {
    setLoading('gg-btn', false);
    // Silently ignore if user just closed the popup
    if (e.code !== 'auth/popup-closed-by-user' && e.code !== 'auth/cancelled-popup-request') {
      const msg = e.message.includes('Firebase') ? e.message : getFirebaseErrorMsg(e.code);
      if (msg) toast(msg, 'error');
    }
  }
}

async function forgotPassword() {
  const email = document.getElementById('si-email').value.trim();
  if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
    showError('si-email', 'Enter your email address first');
    return;
  }
  try {
    await waitForFirebase();
    await window._fbResetPwd(email);
    toast('Password reset email sent! Check your inbox.', 'success');
  } catch (e) {
    toast(e.message.includes('Firebase') ? e.message : getFirebaseErrorMsg(e.code), 'error');
  }
}

function enterApp(name, email) {
  const initials = name.split(' ').slice(0, 2).map(x => x[0] || '').join('').toUpperCase() || 'HR';
  const shortEmail = email.length > 24 ? email.substring(0, 22) + 'â€¦' : email;

  // Update sidebar
  document.getElementById('u-ava').textContent = initials;
  document.getElementById('u-nm').textContent = name;

  // Update topbar email badge
  document.getElementById('ue-dot').textContent = initials;
  document.getElementById('ue-email').textContent = shortEmail;

  // Update settings
  document.getElementById('set-nm').value = name;
  document.getElementById('set-em').value = email;

  // Load any saved user data
  userData = { name, email, company: '', role: '' };

  // Load from Firestore if available
  const user = window._currentUser;
  if (user && window._fbGetDoc) {
    window._fbGetDoc(user.uid).then(snap => {
      if (snap.exists()) {
        const d = snap.data();
        if (d.company) document.getElementById('set-co').value = d.company;
        if (d.role)    document.getElementById('set-rl').value = d.role;
        if (d.pipeline) {
          try { pipeline = JSON.parse(d.pipeline); } catch(e) {}
        }
        buildPipeline();
        updateStats();
      }
    }).catch(() => {});
  }

  // Init demo pipeline entry
  if (!pipeline['New Lead'].length && !pipeline['Contacted'].length) {
    pipeline['New Lead'].push({
      name: 'Adaora Nwosu', title: 'Senior Frontend Engineer', loc: 'Lagos, Nigeria',
      skills: ['React', 'TypeScript', 'Node.js'], score: 96, av: '#7c3aed', company: 'Flutterwave', exp: '6 years'
    });
  }

  buildPipeline();
  buildAnalytics();
  updateStats();

  document.getElementById('auth-page').classList.remove('active');
  document.getElementById('app-page').classList.add('active');

  // Hide config banner if real auth
  if (!DEMO_MODE) document.getElementById('config-banner').classList.add('hide');

  goPanel('ai-search', document.querySelector('.nav-item'));
}

function showAuth() {
  document.getElementById('app-page').classList.remove('active');
  document.getElementById('auth-page').classList.add('active');
}

function confirmLogout() {
  if (!confirm('Sign out of TalentScout AI?')) return;
  if (window._fbSignOut) {
    window._fbSignOut();
  } else {
    showAuth();
  }
}

function saveSettings() {
  const name = document.getElementById('set-nm').value.trim();
  const co   = document.getElementById('set-co').value.trim();
  const rl   = document.getElementById('set-rl').value.trim();
  const user = window._currentUser;
  if (user && window._fbSetDoc) {
    window._fbSetDoc(user.uid, { name, company: co, role: rl }).catch(() => {});
  }
  const initials = name.split(' ').slice(0,2).map(x=>x[0]||'').join('').toUpperCase()||'HR';
  document.getElementById('u-ava').textContent  = initials;
  document.getElementById('u-nm').textContent   = name;
  document.getElementById('ue-dot').textContent = initials;
  toast('Settings saved!', 'success');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NAVIGATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const PMETA = {
  'ai-search':      { t: 'ğŸ¤– AI Search', s: 'Describe your ideal candidate and let AI find them' },
  'boolean':        { t: 'âš¡ Boolean Query Generator', s: 'Build precision LinkedIn search strings' },
  'profile-search': { t: 'ğŸ” Profile Search', s: 'Analyze a LinkedIn profile or search with a boolean query' },
  'pipeline':       { t: 'ğŸ“‹ Candidate Pipeline', s: 'Track candidates through your hiring stages' },
  'analytics':      { t: 'ğŸ“Š Analytics & Insights', s: 'Your sourcing performance overview' },
  'settings':       { t: 'âš™ï¸ Settings', s: 'Manage your account and preferences' },
};

function goPanel(id, el) {
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  const p = document.getElementById('panel-' + id);
  if (p) p.classList.add('active');
  if (el) el.classList.add('active');
  const m = PMETA[id] || { t: id, s: '' };
  document.getElementById('tb-title').textContent = m.t;
  document.getElementById('tb-sub').textContent = m.s;
  closeSb();
}

function toggleSb() {
  document.getElementById('sidebar').classList.toggle('open');
  document.getElementById('mob-ov').classList.toggle('show');
}
function closeSb() {
  document.getElementById('sidebar').classList.remove('open');
  document.getElementById('mob-ov').classList.remove('show');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AI SEARCH â€” Uses Claude AI Agent via Anthropic API
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function setMode(m) {
  document.getElementById('sec-ai').style.display = m === 'ai' ? 'block' : 'none';
  document.getElementById('sec-manual').style.display = m === 'manual' ? 'block' : 'none';
  document.getElementById('mt-ai').classList.toggle('active', m === 'ai');
  document.getElementById('mt-manual').classList.toggle('active', m === 'manual');
}

function setQ(t) { document.getElementById('ai-q').value = t; }

async function runSearch(mode) {
  let query = '';
  if (mode === 'ai') {
    query = document.getElementById('ai-q').value.trim();
    if (!query) { toast('Please describe the candidate you are looking for.', 'error'); return; }
  } else {
    const title = document.getElementById('m-title').value.trim();
    if (!title) { toast('Please enter at least a job title.', 'error'); return; }
    const loc = document.getElementById('m-loc').value.trim();
    const skills = document.getElementById('m-skills').value.trim();
    const exp = document.getElementById('m-exp').value;
    const ind = document.getElementById('m-ind').value;
    const excl = document.getElementById('m-excl').value.trim();
    const desc = document.getElementById('m-desc').value.trim();
    query = `Find ${exp !== 'Any' ? exp + ' ' : ''}${title}${loc ? ' in ' + loc : ''}${skills ? ' with skills: ' + skills : ''}${ind !== 'Any' ? ' from ' + ind + ' industry' : ''}${excl ? '. Exclude: ' + excl : ''}${desc ? '. Job description context: ' + desc.slice(0, 200) : ''}.`;
  }

  const steps = ['Parsing your requirementsâ€¦', 'Querying LinkedIn databaseâ€¦', 'Scoring candidate profilesâ€¦', 'Ranking top matchesâ€¦'];
  showLoader('AI Agent Searching LinkedIn', 'Powered by Claude AI', steps);

  totalSearches++;
  const btnId = mode === 'ai' ? 'ai-run-btn' : 'manual-run-btn';
  document.getElementById(btnId).disabled = true;

  let si = 0;
  const stepsEl = document.getElementById('ld-steps');
  const tick = setInterval(() => {
    if (si < stepsEl.children.length) {
      if (si > 0) stepsEl.children[si - 1].className = 'lstep done';
      stepsEl.children[si].className = 'lstep active';
    }
    si++;
  }, 700);

  try {
    const candidates = await fetchCandidatesFromAI(query);
    clearInterval(tick);
    hideLoader();
    document.getElementById(btnId).disabled = false;
    searchResults = candidates;
    totalScanned += candidates.length * 8; // simulate scanning more than shown
    updateStats();
    renderCandidates(candidates);
    savePipelineToFirestore();
  } catch (e) {
    clearInterval(tick);
    hideLoader();
    document.getElementById(btnId).disabled = false;
    console.error(e);
    toast('Search failed. Check your API key or try again.', 'error');
  }
}

/* â”€â”€ Call Anthropic Claude API â”€â”€ */
async function fetchCandidatesFromAI(query) {
  const systemPrompt = `You are a LinkedIn talent sourcing AI agent. Given a search query, you generate realistic, detailed LinkedIn candidate profiles that match the criteria. 
  
  ALWAYS return a valid JSON array of exactly 6-8 candidates. Each candidate object must have:
  - name: realistic full name matching the region
  - title: current job title 
  - company: current or recent company (real or realistic company names)
  - loc: city, country
  - exp: experience like "4 years" or "8 years"
  - education: highest degree + university
  - skills: array of 5-7 relevant technical skills
  - score: match score 70-99 (higher = better match)
  - summary: 1-sentence professional summary
  - av: one of these hex colors: #7c3aed #0891b2 #10b981 #f59e0b #ef4444 #8b5cf6 #06b6d4 #ec4899 #14b8a6 #f97316 #6366f1 #a855f7
  - connections: number like "500+" or "300+"
  - open_to_work: true or false
  
  Make names geographically relevant. If query mentions Africa/Nigeria/Ghana, use African names. If London, use British/European names. Be realistic and diverse. Return ONLY the JSON array, no markdown, no explanation.`;

  const response = await fetch('https://api.anthropic.com/v1/messages', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      model: 'claude-sonnet-4-20250514',
      max_tokens: 2000,
      system: systemPrompt,
      messages: [{ role: 'user', content: `Search query: ${query}\n\nGenerate matching LinkedIn candidate profiles as a JSON array.` }]
    })
  });

  if (!response.ok) {
    const err = await response.json();
    throw new Error(err.error?.message || 'API error');
  }

  const data = await response.json();
  const text = data.content[0].text.trim();

  // Parse JSON â€” strip any markdown fences if present
  const clean = text.replace(/```json|```/g, '').trim();
  const parsed = JSON.parse(clean);
  return Array.isArray(parsed) ? parsed : [];
}

function renderCandidates(list) {
  const grid = document.getElementById('cand-grid');
  grid.innerHTML = '';

  list.forEach((c, i) => {
    const score = Math.min(99, Math.max(60, c.score || 80));
    const deg = (score / 100) * 360;
    const scoreColor = score >= 90 ? '#10b981' : score >= 75 ? '#f59e0b' : '#6366f1';
    const initials = (c.name || 'UN').split(' ').slice(0, 2).map(x => x[0]).join('');
    const av = c.av || AV_COLORS[i % AV_COLORS.length];
    const openTag = c.open_to_work ? '<span style="background:rgba(16,185,129,.12);border:1px solid rgba(16,185,129,.25);color:var(--gn);padding:2px 8px;border-radius:99px;font-size:10px;font-weight:700;margin-left:6px">#OpenToWork</span>' : '';

    const card = document.createElement('div');
    card.className = 'cc';
    card.style.animationDelay = (i * 0.06) + 's';
    card.innerHTML = `
      <div class="cc-hd">
        <div class="cc-ava" style="background:${av}">${initials}</div>
        <div class="cc-info">
          <div class="cc-nm">${c.name}${openTag}</div>
          <div class="cc-rl">${c.title}</div>
          <div class="cc-exp">ğŸ¢ ${c.company || 'â€”'} &nbsp;Â·&nbsp; ${c.exp || ''}</div>
          <div class="cc-lc">ğŸ“ ${c.loc} &nbsp;Â·&nbsp; ${c.connections || '500+'} connections</div>
        </div>
        <div class="cc-score">
          <div class="score-ring" style="background:conic-gradient(${scoreColor} ${deg}deg, rgba(255,255,255,.06) 0deg)">
            <div class="score-val" style="color:${scoreColor}">${score}%</div>
          </div>
          <div class="score-lbl">Match</div>
        </div>
      </div>
      ${c.education ? `<div class="cc-company"><span>ğŸ“</span> ${c.education}</div>` : ''}
      ${c.summary ? `<div style="font-size:11px;color:var(--t2);margin-bottom:10px;line-height:1.5;font-style:italic">"${c.summary}"</div>` : ''}
      <div class="cc-skills">${(c.skills || []).slice(0, 5).map(s => `<span class="sk-tag">${s}</span>`).join('')}</div>
      <div class="cc-acts">
        <button class="cc-btn p" onclick='addToPipe(${JSON.stringify(c)})'>+ Pipeline</button>
        <button class="cc-btn s" onclick="liOpen('${c.name}','${c.title}')">ğŸ”— LinkedIn</button>
      </div>`;
    grid.appendChild(card);
  });

  document.getElementById('res-cnt').textContent = list.length;
  document.getElementById('res-area').style.display = 'block';
  document.getElementById('res-empty').style.display = 'none';
}

function addToPipe(c) {
  if (!pipeline['New Lead'].find(x => x.name === c.name)) {
    pipeline['New Lead'].push(c);
    buildPipeline();
    updateStats();
    savePipelineToFirestore();
    toast(`${c.name} added to pipeline âœ“`, 'success');
  } else {
    toast(`${c.name} is already in your pipeline`, 'error');
  }
}

function addAll() {
  let added = 0;
  searchResults.forEach(c => {
    if (!pipeline['New Lead'].find(x => x.name === c.name)) {
      pipeline['New Lead'].push(c);
      added++;
    }
  });
  buildPipeline(); updateStats(); savePipelineToFirestore();
  toast(`${added} candidate${added !== 1 ? 's' : ''} added to pipeline!`, 'success');
}

function liOpen(name, title) {
  window.open('https://www.linkedin.com/search/results/people/?keywords=' + encodeURIComponent(name + ' ' + (title || '')), '_blank');
}

function exportCSV() {
  if (!searchResults.length) { toast('No results to export.', 'error'); return; }
  let csv = 'Name,Title,Company,Location,Experience,Skills,Match Score,Education\n';
  searchResults.forEach(c => {
    csv += `"${c.name}","${c.title}","${c.company||''}","${c.loc}","${c.exp||''}","${(c.skills||[]).join('; ')}","${c.score}%","${c.education||''}"\n`;
  });
  const a = document.createElement('a');
  a.href = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv);
  a.download = `talentscout_results_${new Date().toISOString().slice(0,10)}.csv`;
  a.click();
  toast('CSV exported!', 'success');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BOOLEAN QUERY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function addCtag(e) {
  if (e.key !== 'Enter') return;
  const v = e.target.value.trim();
  if (!v) return;
  const s = document.createElement('span');
  s.className = 'ctag';
  s.innerHTML = `${v} <span class="ctag-x" onclick="this.parentElement.remove()">Ã—</span>`;
  document.getElementById('ctag-list').appendChild(s);
  e.target.value = '';
}

function genBool() {
  const titles = document.getElementById('b-titles').value;
  const skills = document.getElementById('b-skills').value;
  const opt = document.getElementById('b-opt').value;
  const inc = document.getElementById('b-inc').value;
  const exc = document.getElementById('b-exc').value;
  const reg = document.getElementById('b-reg').value;

  let parts = [];
  if (titles) parts.push('(' + titles.split(',').map(t => `"${t.trim()}"`).join(' OR ') + ')');
  else parts.push('("Software Engineer" OR "Developer" OR "Engineer")');
  if (skills) parts.push('(' + skills.split(',').map(s => `"${s.trim()}"`).join(' AND ') + ')');
  if (opt) parts.push('(' + opt.split(',').map(s => `"${s.trim()}"`).join(' OR ') + ')');
  if (inc) parts.push('(' + inc.split(',').map(s => `"${s.trim()}"`).join(' OR ') + ')');
  if (reg) parts.push('(' + reg.split(',').map(r => `"${r.trim()}"`).join(' OR ') + ')');
  if (exc) parts.push('NOT (' + exc.split(',').map(e => `"${e.trim()}"`).join(' OR ') + ')');

  const str = parts.join(' AND ');
  document.getElementById('bool-txt').textContent = str;
  document.getElementById('bool-res').style.display = 'block';
  toast('Boolean query generated!', 'success');
}

function clearBool() {
  ['b-titles','b-skills','b-opt','b-inc','b-exc','b-reg','b-codes'].forEach(id => {
    const el = document.getElementById(id); if (el) el.value = '';
  });
  document.getElementById('bool-res').style.display = 'none';
}

function copyBool() {
  const t = document.getElementById('bool-txt').textContent;
  navigator.clipboard.writeText(t).then(() => toast('Copied to clipboard!', 'success'));
}

function liSearch() {
  const q = document.getElementById('bool-txt').textContent;
  if (!q) { toast('Generate a query first.', 'error'); return; }
  window.open('https://www.linkedin.com/search/results/people/?keywords=' + encodeURIComponent(q), '_blank');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROFILE SEARCH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function pstab(t, btn) {
  document.querySelectorAll('.ps-tab').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.ps-cont').forEach(c => c.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById('ps-' + t).classList.add('active');
}

async function scrapeProfile() {
  const url = document.getElementById('ps-url').value.trim();
  if (!url) { toast('Please enter a LinkedIn profile URL', 'error'); return; }

  const jTitle = document.getElementById('ps-jt').value.trim();
  const jLoc = document.getElementById('ps-jl').value.trim();
  const jSkills = document.getElementById('ps-js').value.trim();
  const jDesc = document.getElementById('ps-jd').value.trim();

  showLoader('Scraping LinkedIn Profile', 'Extracting & analyzing profile data', ['Fetching profileâ€¦', 'Extracting dataâ€¦', 'Analyzing skillsâ€¦', 'Scoring match qualityâ€¦']);

  // Extract username from URL
  const usernameMatch = url.match(/linkedin\.com\/in\/([^\/\?]+)/);
  const username = usernameMatch ? usernameMatch[1] : 'unknown';

  try {
    // Use AI to generate realistic profile analysis
    const prompt = `Simulate scraping this LinkedIn profile: linkedin.com/in/${username}

Job requirements being matched against:
- Title: ${jTitle || 'Not specified'}
- Location: ${jLoc || 'Not specified'}
- Skills needed: ${jSkills || 'Not specified'}
- Job description: ${jDesc ? jDesc.slice(0, 200) : 'Not provided'}

Return a JSON object with these fields:
{
  "name": "realistic name for username ${username}",
  "title": "current job title",
  "company": "current company",
  "loc": "city, country",
  "exp": "X years",
  "education": "degree + university",
  "skills": ["skill1", "skill2", "skill3", "skill4", "skill5", "skill6"],
  "score": number 65-98,
  "summary": "professional summary 2 sentences",
  "strengths": ["strength1", "strength2", "strength3"],
  "gaps": ["potential gap1", "potential gap2"],
  "recommendation": "hire/strong_consider/consider/pass",
  "av": "#6366f1"
}
Return ONLY JSON, no markdown.`;

    const res = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        model: 'claude-sonnet-4-20250514',
        max_tokens: 1000,
        messages: [{ role: 'user', content: prompt }]
      })
    });

    const data = await res.json();
    const c = JSON.parse(data.content[0].text.replace(/```json|```/g, '').trim());
    const scoreColor = c.score >= 90 ? '#10b981' : c.score >= 75 ? '#f59e0b' : '#6366f1';
    const recColors = { hire: '#10b981', strong_consider: '#22d3ee', consider: '#f59e0b', pass: '#f43f5e' };
    const recText = { hire: 'âœ… Strong Hire', strong_consider: 'ğŸ‘ Strong Consider', consider: 'ğŸ¤” Consider', pass: 'âŒ Pass' };

    document.getElementById('ps-result-body').innerHTML = `
      <div style="display:flex;align-items:center;gap:16px;margin-bottom:20px;flex-wrap:wrap">
        <div style="width:64px;height:64px;border-radius:50%;background:${c.av||'#6366f1'};display:flex;align-items:center;justify-content:center;font-size:22px;font-weight:800;color:#fff;flex-shrink:0">${(c.name||'?').split(' ').map(x=>x[0]).join('')}</div>
        <div style="flex:1">
          <div style="font-size:18px;font-weight:800">${c.name}</div>
          <div style="font-size:13px;color:var(--t2)">${c.title} Â· ${c.company}</div>
          <div style="font-size:12px;color:var(--t3);margin-top:3px">ğŸ“ ${c.loc} &nbsp;Â·&nbsp; ${c.exp} experience &nbsp;Â·&nbsp; ğŸ“ ${c.education}</div>
        </div>
        <div style="text-align:center">
          <div style="font-size:36px;font-weight:800;color:${scoreColor}">${c.score}%</div>
          <div style="font-size:11px;color:var(--t3)">Match Score</div>
          <div style="font-size:12px;font-weight:700;color:${recColors[c.recommendation]||'var(--gn)'};margin-top:4px">${recText[c.recommendation]||'Consider'}</div>
        </div>
      </div>
      <div style="font-size:13px;color:var(--t2);line-height:1.7;margin-bottom:16px;font-style:italic;background:var(--s2);padding:14px;border-radius:var(--rad-s);border-left:3px solid var(--ind)">"${c.summary}"</div>
      <div style="display:flex;flex-wrap:wrap;gap:6px;margin-bottom:16px">${(c.skills||[]).map(s=>`<span class="tag cy">${s}</span>`).join('')}</div>
      <div class="g2" style="gap:12px;margin-bottom:16px">
        <div style="background:rgba(16,185,129,.06);border:1px solid rgba(16,185,129,.15);border-radius:var(--rad-s);padding:14px">
          <div style="font-size:12px;font-weight:700;color:var(--gn);margin-bottom:8px">âœ… Strengths</div>
          ${(c.strengths||[]).map(s=>`<div style="font-size:12px;color:var(--t2);margin-bottom:4px">â€¢ ${s}</div>`).join('')}
        </div>
        <div style="background:rgba(245,158,11,.06);border:1px solid rgba(245,158,11,.15);border-radius:var(--rad-s);padding:14px">
          <div style="font-size:12px;font-weight:700;color:var(--am);margin-bottom:8px">âš ï¸ Potential Gaps</div>
          ${(c.gaps||[]).map(g=>`<div style="font-size:12px;color:var(--t2);margin-bottom:4px">â€¢ ${g}</div>`).join('')}
        </div>
      </div>
      <div class="brow">
        <button class="btn-ind" onclick='addToPipe(${JSON.stringify(c)})'>+ Add to Pipeline</button>
        <button class="btn-gh" onclick="liOpen('${c.name}','${c.title}')">ğŸ”— View on LinkedIn</button>
      </div>`;
    document.getElementById('ps-result').style.display = 'block';
    hideLoader();
    toast('Profile analyzed successfully!', 'success');
  } catch (e) {
    hideLoader();
    toast('Profile analysis failed. Check your API key.', 'error');
  }
}

function psQuery() {
  const q = document.getElementById('ps-q').value.trim();
  if (!q) { toast('Please enter a search query.', 'error'); return; }
  goPanel('ai-search', document.querySelectorAll('.nav-item')[0]);
  document.getElementById('ai-q').value = q;
  runSearch('ai');
}

function onResume(input) {
  const f = input.files[0];
  if (!f) return;
  const el = document.getElementById('rf-name');
  el.style.display = 'inline-flex';
  el.className = 'tag gn';
  el.textContent = 'ğŸ“„ ' + f.name + ' (uploaded)';
  toast('Resume uploaded: ' + f.name + ' â€” Connect backend to analyze.', 'success');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   QUICK ADD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function openQA() {
  ['qa-nm','qa-tt','qa-li','qa-lc','qa-em','qa-co','qa-sk','qa-nt'].forEach(id => {
    const el = document.getElementById(id); if (el) el.value = '';
  });
  document.getElementById('qa-ava-big').textContent = '?';
  document.getElementById('qa-pn').textContent = 'New Candidate';
  document.getElementById('qa-pr').textContent = 'Fill in the details below';
  document.getElementById('qa-modal').classList.add('show');
}

function closeQA() { document.getElementById('qa-modal').classList.remove('show'); }

function qaPreview() {
  const n = document.getElementById('qa-nm').value || 'New Candidate';
  const t = document.getElementById('qa-tt').value || 'Fill in the details below';
  const init = n.split(' ').slice(0, 2).map(x => x[0] || '').join('').toUpperCase() || '?';
  document.getElementById('qa-ava-big').textContent = init;
  document.getElementById('qa-pn').textContent = n;
  document.getElementById('qa-pr').textContent = t;
}

function submitQA() {
  const name = document.getElementById('qa-nm').value.trim();
  if (!name) { toast('Please enter a candidate name', 'error'); return; }
  const c = {
    name,
    title: document.getElementById('qa-tt').value || 'â€”',
    company: document.getElementById('qa-co').value || '',
    loc: document.getElementById('qa-lc').value || 'â€”',
    exp: document.getElementById('qa-yrs').value || '',
    skills: document.getElementById('qa-sk').value.split(',').map(s => s.trim()).filter(Boolean),
    score: 70 + Math.floor(Math.random() * 25),
    av: AV_COLORS[Math.floor(Math.random() * AV_COLORS.length)],
    addedManually: true,
    source: document.getElementById('qa-src').value,
  };
  const stage = document.getElementById('qa-stage').value;
  pipeline[stage].push(c);
  buildPipeline(); updateStats(); savePipelineToFirestore(); closeQA();
  toast(`${name} added to ${stage}!`, 'success');
  goPanel('pipeline', document.querySelectorAll('.nav-item')[3]);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PIPELINE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildPipeline() {
  const board = document.getElementById('pipe-board');
  board.innerHTML = '';
  STAGES.forEach(stage => {
    const cs = pipeline[stage] || [];
    const col = document.createElement('div');
    col.className = 'pipe-col';
    col.innerHTML = `
      <div class="pipe-col-hd">
        <div class="pipe-col-nm" style="color:${STAGE_COLORS[stage]}">${stage}</div>
        <span class="pipe-cnt">${cs.length}</span>
      </div>
      ${cs.length === 0
        ? '<div style="font-size:12px;color:var(--t3);text-align:center;padding:24px 0">No candidates</div>'
        : cs.map((c, i) => `
          <div class="pipe-card">
            <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px">
              <div style="width:28px;height:28px;border-radius:50%;background:${c.av||'#6366f1'};display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:800;color:#fff;flex-shrink:0">${c.name.split(' ').slice(0,2).map(x=>x[0]).join('')}</div>
              <div class="pipe-nm">${c.name}</div>
              ${c.score ? `<div style="margin-left:auto;font-size:10px;font-weight:700;color:var(--gn)">${c.score}%</div>` : ''}
            </div>
            <div class="pipe-rl">${c.title || 'â€”'}${c.company ? ' Â· ' + c.company : ''}</div>
            ${c.loc ? `<div style="font-size:10px;color:var(--t3);margin-top:2px">ğŸ“ ${c.loc}</div>` : ''}
            ${c.skills && c.skills.length ? `<div style="margin-top:7px;display:flex;flex-wrap:wrap;gap:4px">${c.skills.slice(0,3).map(s=>`<span class="tag" style="font-size:10px;padding:2px 7px">${s}</span>`).join('')}</div>` : ''}
            <div class="pipe-acts">
              ${STAGES.filter(s => s !== stage).slice(0, 3).map(s =>
                `<button class="pipe-btn" onclick="mvStage('${stage}',${i},'${s}')">â†’ ${s.split(' ')[0]}</button>`
              ).join('')}
              <button class="pipe-btn" style="color:var(--rs);border-color:rgba(244,63,94,.3)" onclick="removeFromPipe('${stage}',${i})">âœ•</button>
            </div>
          </div>`).join('')}
    `;
    board.appendChild(col);
  });
}

function mvStage(from, idx, to) {
  const [c] = pipeline[from].splice(idx, 1);
  pipeline[to].push(c);
  buildPipeline(); updateStats(); savePipelineToFirestore();
  toast(`${c.name} â†’ ${to}`, 'success');
}

function removeFromPipe(stage, idx) {
  const c = pipeline[stage][idx];
  if (!confirm(`Remove ${c.name} from pipeline?`)) return;
  pipeline[stage].splice(idx, 1);
  buildPipeline(); updateStats(); savePipelineToFirestore();
  toast(`${c.name} removed from pipeline`, 'success');
}

function clearPipeline() {
  if (!confirm('Clear ALL candidates from the pipeline? This cannot be undone.')) return;
  pipeline = Object.fromEntries(STAGES.map(s => [s, []]));
  buildPipeline(); updateStats(); savePipelineToFirestore();
  toast('Pipeline cleared.', 'success');
}

function updateStats() {
  const total = STAGES.reduce((s, st) => s + pipeline[st].length, 0);
  const hired = (pipeline['Hired'] || []).length;
  document.getElementById('pipe-badge').textContent = total;
  document.getElementById('st-pipe').textContent = total;
  document.getElementById('st-hired').textContent = hired;
  document.getElementById('st-searches').textContent = totalSearches;
  document.getElementById('st-scanned').textContent = totalScanned > 0 ? totalScanned.toLocaleString() : '0';
}

function savePipelineToFirestore() {
  const user = window._currentUser;
  if (user && window._fbSetDoc) {
    window._fbSetDoc(user.uid, { pipeline: JSON.stringify(pipeline) }).catch(() => {});
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANALYTICS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildAnalytics() {
  const vals = [3,8,12,6,18,24,20,15,22,28,19,31,14,21];
  const mx = Math.max(...vals);
  document.getElementById('bar-ch').innerHTML = vals.map(v =>
    `<div class="bar" style="height:${Math.round(v/mx*90)}%" title="${v} searches"></div>`
  ).join('');

  const roles = [
    { r: 'Frontend Engineer', n: 48 },
    { r: 'Backend Developer', n: 41 },
    { r: 'Data Scientist', n: 35 },
    { r: 'DevOps Engineer', n: 29 },
    { r: 'Product Manager', n: 22 },
  ];
  document.getElementById('top-roles').innerHTML = roles.map(x => `
    <div class="role-it">
      <div class="role-nm"><span>${x.r}</span><span style="color:var(--t2)">${x.n}</span></div>
      <div class="role-bar"><div class="role-fill" style="width:${Math.round(x.n/48*100)}%"></div></div>
    </div>`).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOADER / TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showLoader(t, s, steps) {
  document.getElementById('ld-ttl').textContent = t;
  document.getElementById('ld-sb').textContent = s;
  const el = document.getElementById('ld-steps');
  el.innerHTML = (steps || []).map(x => `<div class="lstep"><div class="lstep-dot"></div>${x}</div>`).join('');
  document.getElementById('ld-ov').classList.add('show');
}

function hideLoader() { document.getElementById('ld-ov').classList.remove('show'); }

function toast(msg, type = 'success') {
  const el = document.getElementById('toast-el');
  document.getElementById('toast-msg').textContent = msg;
  document.getElementById('toast-ico').textContent = type === 'success' ? 'âœ…' : 'âš ï¸';
  el.className = `toast ${type} show`;
  setTimeout(() => el.classList.remove('show'), 3500);
}
</script>
</body>
</html>
